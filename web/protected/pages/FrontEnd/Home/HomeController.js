var PageJs=new Class.create();PageJs.prototype=Object.extend(new FrontPageJs(),{resultDivId:"",getProductsBtn:"",pagination:{pageNo:1,pageSize:10},searchCriteria:{searchString:"",categories:[]},getProductItemFunc:"_getProductGridItem",initialize:function(b,a){this.resultDivId=b;this.getProductsBtn=a},showProducts:function(){var a={};a.me=this;pageJs.postAjax(this.getProductsBtn,{pagination:a.me.pagination,searchCriteria:a.me.searchCriteria},{onLoading:function(){$(this.resultDivId).update(a.me._getLoadingDiv())},onComplete:function(b,d){a.resultDiv=new Element("div");try{a.result=pageJs.getResp(d,false,true);if(!a.result.pagination||a.result.pagination.totalRows===0){throw"Nothing found!"}a.resultDiv.insert({bottom:a.me._getPaginationDiv(a.result.pagination)});a.result.products.each(function(e){a.resultDiv.insert({bottom:a.me[a.me.getProductItemFunc](e)})});a.resultDiv.insert({bottom:a.me._getPaginationDiv(a.result.pagination)})}catch(c){a.resultDiv.update(new Element("div",{"class":"errMsg"}).update(c))}$(a.me.resultDivId).update(a.resultDiv)}});return this},_getLoadingDiv:function(){return new Element("span",{"class":"loading"}).insert({bottom:new Element("img",{src:"/themes/default/images/loading.gif"})}).insert({bottom:"Loading ..."})},_getPaginationDiv:function(a){var b={};if(a.totalPages===1){return}b.me=this;b.paginationDiv=new Element("div",{"class":"pagination_wrapper"});b.windowSize=5;b.morePages=true;if(a.totalPages<b.windowSize){b.morePages=false;b.windowSize=a.totalPages}if(Math.ceil(b.windowSize/2)>a.pageNumber){b.pageStart=1}else{b.pageStart=a.pageNumber-(Math.ceil(b.windowSize/2)-1);if(Math.ceil(b.windowSize/2)>(a.totalPages-a.pageNumber)){b.pageStart=a.totalPages-b.windowSize+1}if(b.morePages){b.paginationDiv.insert({bottom:b.me._getPaginationBtn("<<",1)}).insert({bottom:b.me._getPaginationBtn("<",(a.pageNumber-1)<0?1:(a.pageNumber-1))})}}$R(b.pageStart,b.pageStart+(b.windowSize-1)).each(function(c){b.paginationDiv.insert({bottom:b.me._getPaginationBtn(c,c).addClassName(c===(a.pageNumber*1)?" selected":"")})});if(b.morePages&&Math.ceil(b.windowSize/2)<=(a.totalPages-a.pageNumber)){b.paginationDiv.insert({bottom:b.me._getPaginationBtn(">",a.pageNumber>a.totalPages?a.totalPages:(a.pageNumber*1+1))}).insert({bottom:b.me._getPaginationBtn(">>",a.totalPages)})}return b.paginationDiv},changePage:function(b,a){this.pagination.pageNo=b;this.pagination.pageSize=a;this.showProducts()},_getPaginationBtn:function(a,b){var c={};c.me=this;return new Element("span",{"class":"pagin_btn cursorpntr"}).update(a).observe("click",function(){c.me.changePage(b,c.me.pagination.pageSize)})},_getProductListItem:function(b){var a={};a.me=this;a.productDiv=new Element("div",{"class":"product listitem"}).insert({bottom:new Element("span",{"class":"inlineblock listcol left"}).insert({bottom:a.me._getProductImgDiv(b.attributes.image_thumb||null)})}).insert({bottom:new Element("span",{"class":"inlineblock listcol right"}).insert({bottom:new Element("div",{"class":"product_title"}).update(b.title)}).insert({bottom:new Element("div",{"class":"row"}).insert({bottom:new Element("span",{"class":"author inlineblock"}).insert({bottom:new Element("label").update("Author:")}).insert({bottom:new Element("span").update(b.attributes.author?a.me._getAttrString(b.attributes.author).join(" "):"")})}).insert({bottom:new Element("span",{"class":"product_isbn inlineblock textright"}).insert({bottom:new Element("label").update("ISBN:")}).insert({bottom:new Element("span").update(b.attributes.isbn?a.me._getAttrString(b.attributes.isbn).join(" "):"")})})}).insert({bottom:new Element("div",{"class":"row"}).insert({bottom:new Element("span",{"class":"product_publisher inlineblock"}).insert({bottom:new Element("label").update("Publisher:")}).insert({bottom:new Element("span").update(b.attributes.publisher?a.me._getAttrString(b.attributes.publisher).join(" "):"")})}).insert({bottom:new Element("span",{"class":"product_publish_date inlineblock textright"}).insert({bottom:new Element("label").update("Publisher Date:")}).insert({bottom:new Element("span").update(b.attributes.publish_date?a.me._getAttrString(b.attributes.publish_date).join(" "):"")})})}).insert({bottom:new Element("div",{"class":"product_description"}).update((b.attributes.description?a.me._getAttrString(b.attributes.description).join(" "):""))})});return a.productDiv},_getProductGridItem:function(b){var a={};a.me=this;a.productDiv=new Element("span",{"class":"product griditem inlineblock cursorpntr"}).insert({bottom:a.me._getProductImgDiv(b.attributes.image_thumb||null)}).insert({bottom:new Element("div",{"class":"product_details"}).insert({bottom:new Element("div",{"class":"product_title"}).update(b.title)})});return a.productDiv},_getAttrString:function(a){return a.map(function(b){return b.attribute||""})},_getProductImgDiv:function(a){var b={};if(a===undefined||a===null||a.size()===0){return new Element("div",{"class":"product_image noimage"})}return new Element("div",{"class":"product_image",src:a[0].attribute})}});